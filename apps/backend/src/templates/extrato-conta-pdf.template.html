<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Extrato de Conta - {{accountName}}</title>
    <style>
      /* Fonte padrão do sistema */
      @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

      body {
        font-family: 'Roboto', Arial, sans-serif;
        margin: 0;
        font-size: 10pt;
        color: #333;
        background-color: #fff;
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        border-bottom: 2px solid #000;
        padding-bottom: 10px;
        margin-bottom: 15px;
      }
      .logo img {
        max-height: 60px;
        max-width: 200px;
      }
      .empresa-info {
        text-align: right;
        font-size: 8pt;
        line-height: 1.4;
      }
      .titulo-relatorio {
        text-align: center;
        font-size: 16pt;
        font-weight: bold;
        margin-bottom: 25px;
        text-transform: uppercase;
      }
      .content-section {
        margin-bottom: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        page-break-inside: avoid;
        overflow: hidden;
      }
      .section-title {
        font-size: 12pt;
        font-weight: bold;
        background-color: #f2f2f2;
        padding: 8px 12px;
        border-bottom: 1px solid #ddd;
      }
      .section-content {
        padding: 12px;
      }
      .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .item {
        display: flex;
        flex-direction: column;
      }
      .item .label {
        font-size: 8pt;
        color: #666;
        margin-bottom: 2px;
        text-transform: uppercase;
      }
      .item .value {
        font-size: 11pt;
        font-weight: bold;
      }

      table { width: 100%; border-collapse: collapse; margin-bottom: 0px; font-size: 9pt; }
      th {
        background-color: #f2f2f2;
        color: #333;
        text-align: left;
        padding: 6px 4px;
        border-bottom: 2px solid #000;
        font-weight: bold;
        text-transform: uppercase;
        font-size: 8pt;
      }
      td {
        padding: 4px;
        border-bottom: 1px solid #000;
        vertical-align: top;
      }
      tr:nth-child(even) {
        background-color: #fafafa;
      }
      .text-right {
        text-align: right;
      }
      .text-red {
        color: #c0392b;
      }
      .text-green {
        color: #27ae60;
      }
      .font-bold {
        font-weight: bold;
      }

      /* Prevent orphan summary */
      .summary-box {
        display: flex;
        justify-content: flex-end;
        gap: 20px;
        margin-top: 0px;
        padding: 5px 10px;
        background-color: #f8f9fa;
        border: 1px solid #000;
        border-top: none; /* Connect to table visually if needed, or just keep close */
        border-radius: 0 0 5px 5px;
        page-break-inside: avoid;
      }
      .summary-item {
        text-align: right;
      }
      .summary-label {
        font-size: 9pt;
        color: #666;
        text-transform: uppercase;
      }
      .summary-value {
        font-size: 14pt;
        font-weight: bold;
      }

      .footer {
        display: none;
      }
      
      @media print {
        body {
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="logo">
        <img src="{{logoUrl}}" alt="Logo" />
      </div>
      <div class="empresa-info">
        <strong>ELECTROSAL</strong><br>
        Relatório de Extrato Bancário<br>
        Emissão: {{currentDate}}
      </div>
    </header>

    <main>
      <div class="account-info" style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #000; padding-bottom: 5px; margin-bottom: 10px;">
          <div>
            <span style="font-size: 14pt; font-weight: bold;">EXTRATO DE CONTA</span><br>
            <span style="font-size: 10pt;">{{accountName}} ({{accountNumber}})</span>
          </div>
          <div style="text-align: right; font-size: 9pt;">
            <span>Período: <strong>{{startDate}} a {{endDate}}</strong></span><br>
            <span>Moeda: {{currency}}</span>
          </div>
      </div>

      <section class="content-section" style="border: none;">
        <table style="font-size: 8pt;">
            <thead>
                <tr>
                    <th style="width: 50px;">Data</th>
                    <th>Histórico</th>
                    <th class="text-right" style="width: 60px;">Cotação</th>
                    <th class="text-right" style="width: 80px;">Valor (R$)</th>
                    <th class="text-right" style="width: 70px;">Valor (Au)</th>
                    <th class="text-right" style="width: 80px;">Saldo (Au)</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background-color: #f0f0f0; font-weight: bold;">
                    <td>{{startDate}}</td>
                    <td>SALDO ANTERIOR</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td class="text-right">
                        {{formatGold saldoAnteriorGold}}
                    </td>
                </tr>
                {{#each transactions}}
                <tr>
                    <td>{{this.date}}</td>
                    <td>
                        <div style="font-weight: 500;">{{this.description}}</div>
                        {{#if this.entityName}}
                            <div style="color: #666; font-size: 7pt; margin-top: 1px;">{{this.entityName}}</div>
                        {{/if}}
                    </td>
                    <td class="text-right">{{this.quotation}}</td>
                    <td class="text-right {{#if (isNegative this.amountBRL)}}text-red{{else}}text-green{{/if}}">
                        {{formatCurrency this.amountBRL}}
                    </td>
                    <td class="text-right">
                        {{formatGold this.amountGold}}
                    </td>
                    <td class="text-right font-bold">
                        {{formatGold this.balanceGold}}
                    </td>
                </tr>
                {{/each}}
            </tbody>
        </table>
      </section>

      <div class="summary-box">
        <div class="summary-item">
            <div class="summary-label">Saldo Final (Au)</div>
            <div class="summary-value" style="font-size: 12pt;">
                {{formatGold saldoFinalGold}}
            </div>
        </div>
      </div>

    </main>

    <footer class="footer">
    </footer>
  </body>
</html>